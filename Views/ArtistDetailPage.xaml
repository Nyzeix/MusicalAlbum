<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:MusicalAlbum.ViewModel"
             xmlns:models="clr-namespace:MusicalAlbum.Models"
             x:Class="MusicalAlbum.Views.ArtistDetailPage">

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="20">

            <!-- Carte artiste -->
            <Border Stroke="LightGray"
                    StrokeThickness="1"
                    StrokeShape="RoundRectangle 16"
                    BackgroundColor="White"
                    Padding="20"
                    Margin="10">

                <VerticalStackLayout Spacing="15">

                    <!-- Info Artiste -->
                    <HorizontalStackLayout Spacing="15">
                        <Image Source="{Binding Artist.Photo}"
                               WidthRequest="150"
                               HeightRequest="150"
                               Aspect="AspectFill"
                               VerticalOptions="Center"
                               HorizontalOptions="Start"
                               Margin="4"/>
                        <VerticalStackLayout VerticalOptions="Center">
                            <Label Text="{Binding Artist.Name}"
                                   FontSize="28"
                                   FontAttributes="Bold"
                                   TextColor="Black"/>
                            <Label Text="{Binding Artist.Genre}"
                                   FontSize="18"
                                   TextColor="DimGray"/>
                        </VerticalStackLayout>
                    </HorizontalStackLayout>

                    <!-- Séparateur -->
                    <BoxView HeightRequest="1"
                             Color="LightGray"
                             HorizontalOptions="Fill"
                             Margin="0,10"/>

                    <!-- Bio -->
                    <Label x:Name="BioLabel"
                        Text="{Binding Artist.Bio}"
                        FontSize="16"
                        MaxLines="3"
                        LineBreakMode="WordWrap"
                        TextColor="Black"/>
                    <Button x:Name="SeeMoreButton"
                        Text="Voir plus"
                        FontSize="14"
                        BackgroundColor="Transparent"
                        TextColor="Blue"
                        HorizontalOptions="Start"
                        Clicked="OnSeeMoreClicked"/>
                </VerticalStackLayout>
            </Border>

            <!-- Séparateur -->
            <BoxView HeightRequest="2"
                Color="White"
                HorizontalOptions="Fill"
                Margin="0,10"/>
            
            <!-- Section Albums -->
            <Label Text="Albums"
                   FontSize="22"
                   FontAttributes="Bold"
                   Margin="10,0,0,10" />

            <CollectionView ItemsSource="{Binding Artist.Albums}"
                            SelectionMode="Single"
                            SelectionChanged="OnAlbumSelected">

                <!-- Grille -->
                <CollectionView.ItemsLayout>
                    <GridItemsLayout Orientation="Vertical"
                                     Span="4"
                                     VerticalItemSpacing="12"
                                     HorizontalItemSpacing="12"/>
                </CollectionView.ItemsLayout>

                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="models:Album">
                        <Border Stroke="LightGray"
                                StrokeThickness="1"
                                StrokeShape="RoundRectangle 12"
                                BackgroundColor="White"
                                Padding="4"
                                Margin="4">
                            <VerticalStackLayout Spacing="6">
                                <Image Source="{Binding Cover}"
                                    Aspect="AspectFit"
                                    HeightRequest="50"
                                    HorizontalOptions="Center"/>
                                <Label Text="{Binding Title}"
                                    TextColor="Black"
                                    FontSize="14"
                                    FontAttributes="Bold"
                                    LineBreakMode="TailTruncation"
                                    HorizontalOptions="Start"
                                    VerticalOptions="Start"/>
                                <Label Text="{Binding Year}"
                                    FontSize="12"
                                    TextColor="DimGray"
                                    HorizontalOptions="Start"
                                    VerticalOptions="End"/>
                            </VerticalStackLayout>
                        </Border>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
